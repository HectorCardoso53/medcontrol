<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle de Medicamentos</title>
    <link rel="stylesheet" href="style.css">

    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Cabe√ßalho -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <img src="img/prefeitura.png" alt="Logo da Prefeitura">
                    <h1>Almoxarifado Central - Secretaria Municipal de Sa√∫de</h1>
                </div>
                <button class="menu-toggle" id="menuToggle">‚ò∞</button>
                <nav class="nav-menu">
                    <button class="nav-btn active" data-section="atendimento">
                        <span class="icon">üë•</span>
                        Atendimento
                    </button>
                    <button class="nav-btn" data-section="medicamentos">
                        <span class="icon">üíä</span>
                        Medicamentos
                    </button>
                    <button class="nav-btn" data-section="saidas">
                        <span class="icon">üì§</span>
                        Sa√≠das
                    </button>
                    <button class="nav-btn" data-section="estoque">
                        <span class="icon">üì¶</span>
                        Estoque
                    </button>
                    <button class="nav-btn" data-section="relatorios">
                        <span class="icon">üìä</span>
                        Relat√≥rios
                    </button>
                    <button class="nav-btn" data-section="relacao-atendimentos">
                        <span class="icon">üìã</span>
                        Rela√ß√£o de Atendimentos
                    </button>

                </nav>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- SE√á√ÉO: CADASTRO DE ATENDIMENTO -->
            <section id="atendimento" class="section active">
                <div class="section-header">
                    <h2>Cadastro de Atendimento</h2>
                    <p class="subtitle">Registre atendimentos e distribua medicamentos aos pacientes</p>
                </div>

                <div class="card">
                    <form id="formAtendimento" class="form">
                        <div class="form-grid">

                            <!-- Data + Nome -->
                            <div class="form-group">
                                <label for="dataAtendimento">Data</label>
                                <input type="date" id="dataAtendimento">
                            </div>

                            <div class="form-group">
                                <label for="nomePaciente">Nome do Paciente *</label>
                                <input type="text" id="nomePaciente" placeholder="Ex: Jo√£o Silva" required>
                            </div>

                            <!-- RG + Cart√£o SUS + Contato -->
                            <div class="form-group">
                                <label for="rg">RG</label>
                                <input type="text" id="rg" placeholder="Opcional">
                            </div>

                            <div class="form-group">
                                <label for="cartaoSus">Cart√£o SUS</label>
                                <input type="text" id="cartaoSus" placeholder="Opcional">
                            </div>

                            <div class="form-group">
                                <label for="contato">Contato</label>
                                <input type="tel" id="contato" placeholder="Opcional">
                            </div>

                            <!-- Endere√ßo + Bairro -->
                            <div class="form-group">
                                <label for="endereco">Endere√ßo *</label>
                                <input type="text" id="endereco" placeholder="Ex: Rua das Flores, 123" required>
                            </div>

                            <div class="form-group">
                                <label for="bairro">Bairro *</label>
                                <select id="bairro" required>
                                    <option value="">Selecione</option>
                                </select>
                            </div>


                            <!-- Quantidade -->
                            <div class="form-group full-width">
                                <label>Medicamentos da Receita</label>

                                <div id="listaMedicamentosReceita"></div>

                                <button type="button" class="btn btn-secondary" onclick="adicionarMedicamentoReceita()">
                                    ‚ûï Adicionar medicamento
                                </button>
                            </div>

                        </div>


                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <span class="icon">‚úì</span>
                                Salvar Atendimento
                            </button>
                            <button type="reset" class="btn btn-secondary">
                                <span class="icon">‚Ü∫</span>
                                Limpar
                            </button>
                        </div>
                    </form>
                </div>
            </section>



            <!-- SE√á√ÉO: RELA√á√ÉO DE ATENDIMENTOS -->
            <section id="relacao-atendimentos" class="section">
                <div class="section-header">
                    <h2>Rela√ß√£o de Atendimentos</h2>
                    <p class="subtitle">Consulta geral dos atendimentos registrados no sistema</p>
                </div>

                <div class="card">

                    <div class="form-grid">

                        <!-- ANO -->
                        <div class="form-group">
                            <label>Ano</label>
                            <select id="filtroAno">
                                <option value="">Todos</option>
                                <option value="2026">2026</option>
                                <option value="2027">2027</option>
                                <option value="2028">2028</option>
                            </select>
                        </div>

                        <!-- M√äS -->
                        <div class="form-group">
                            <label>M√™s</label>
                            <select id="filtroMes">
                                <option value="">Todos</option>
                                <option value="01">Jan</option>
                                <option value="02">Fev</option>
                                <option value="03">Mar</option>
                                <option value="04">Abr</option>
                                <option value="05">Mai</option>
                                <option value="06">Jun</option>
                                <option value="07">Jul</option>
                                <option value="08">Ago</option>
                                <option value="09">Set</option>
                                <option value="10">Out</option>
                                <option value="11">Nov</option>
                                <option value="12">Dez</option>
                            </select>
                        </div>

                        <!-- PACIENTE -->
                        <div class="form-group">
                            <label>Paciente</label>
                            <input type="text" id="filtroPaciente" placeholder="Nome do paciente">
                        </div>

                        <!-- MEDICAMENTO (INPUT üî•) -->
                        <div class="form-group">
                            <label>Medicamento</label>
                            <input type="text" id="filtroMedicamento" placeholder="Ex: Amoxicilina">
                        </div>





                        <div class="form-group" style="align-self:end">
                            <button class="btn btn-primary" onclick="filtrarRelacaoAtendimentos()">
                                üîç Filtrar
                            </button>
                            <button class="btn btn-secondary" id="btnPdf" style="display:none"
                                onclick="baixarPdfAtendimentos()">
                                üìÑ Baixar PDF
                            </button>
                        </div>

                    </div>

                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Paciente</th>
                                    <th>Bairro</th>
                                    <th>Medicamento</th>
                                    <th>Quantidade</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaRelacaoAtendimentos"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- SE√á√ÉO: CADASTRO DE MEDICAMENTOS -->
            <section id="medicamentos" class="section">
                <div class="section-header">
                    <h2>Cadastro de Medicamentos</h2>
                    <p class="subtitle">Registre a entrada de medicamentos no estoque</p>
                </div>

                <div class="card">
                    <form id="formMedicamentos" class="form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="codigoMed">C√≥digo do Medicamento</label>
                                <input type="text" id="codigoMed" placeholder="Ex: MED001" required>
                            </div>

                            <div class="form-group">
                                <label for="descricaoMed">Medicamento</label>
                                <select id="descricaoMed" required>
                                    <option value="">Selecione o medicamento</option>
                                </select>
                            </div>


                            <div class="form-group" id="novoMedicamentoGroup" style="display: none;">
                                <label for="novoMedicamento">Novo Medicamento</label>
                                <input type="text" id="novoMedicamento" placeholder="Ex: Paracetamol 500mg">
                            </div>


                            <div class="form-group">
                                <label for="dataRecebimento">Data de Recebimento</label>
                                <input type="date" id="dataRecebimento" required>
                            </div>

                            <div class="form-group">
                                <label for="lote">Lote</label>
                                <input type="text" id="lote" placeholder="Ex: L12345" required>
                            </div>

                            <div class="form-group">
                                <label for="dataValidade">Data de Validade</label>
                                <input type="date" id="dataValidade" required>
                            </div>

                            <div class="form-group">
                                <label for="quantidadeRecebida">Quantidade Recebida</label>
                                <input type="number" id="quantidadeRecebida" min="1" placeholder="0" required>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <span class="icon">‚úì</span>
                                Cadastrar Medicamento
                            </button>
                            <button type="reset" class="btn btn-secondary">
                                <span class="icon">‚Ü∫</span>
                                Limpar
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- SE√á√ÉO: CONTROLE DE SA√çDAS -->
            <section id="saidas" class="section">
                <div class="section-header">
                    <h2>Controle de Sa√≠da de Medicamentos</h2>
                    <p class="subtitle">Visualize todas as sa√≠das registradas no sistema</p>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Medicamento</th>
                                    <th>Lote</th>
                                    <th>Quantidade</th>
                                    <th>Refer√™ncia</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaSaidas"></tbody>
                        </table>

                    </div>
                </div>
            </section>

            <!-- SE√á√ÉO: ESTOQUE -->
            <section id="estoque" class="section">
                <div class="section-header">
                    <h2>Estoque de Medicamentos</h2>
                    <p class="subtitle">Acompanhe o saldo dispon√≠vel e validades</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">üì¶
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Total em Estoque</p>
                            <p class="stat-value" id="totalEstoque">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">‚ö†Ô∏è
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Estoque Baixo</p>
                            <p class="stat-value" id="estoqueBaixo">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">üìÖ
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Pr√≥ximos do Vencimento</p>
                            <p class="stat-value" id="proximosVencer">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">üíä
                        </div>
                        <div class="stat-content">
                            <p class="stat-label">Tipos Cadastrados</p>
                            <p class="stat-value" id="tiposMedicamentos">0</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Medicamento</th>
                                    <th>Total Recebido</th>
                                    <th>Total Distribu√≠do</th>
                                    <th>Saldo</th>
                                    <th>Validade Pr√≥xima</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>

                            <tbody id="tabelaEstoque"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- SE√á√ÉO: RELAT√ìRIOS -->
            <section id="relatorios" class="section">
                <div class="section-header">
                    <h2>Relat√≥rios e An√°lises</h2>
                    <p class="subtitle">Visualize estat√≠sticas e tend√™ncias do sistema</p>
                </div>

                <div class="charts-grid">
                    <div class="card">
                        <h3 class="card-title">Bairros Mais Atendidos</h3>
                        <div class="chart-container">
                            <canvas id="chartBairros"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="card-title">Medicamentos Mais Distribu√≠dos</h3>
                        <div class="chart-container">
                            <canvas id="chartMedicamentos"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Tabela: Bairros</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Bairro</th>
                                    <th>Total de Atendimentos</th>
                                    <th>Percentual</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaBairros"></tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">Tabela: Medicamentos</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Medicamento</th>
                                    <th>Total Distribu√≠do</th>
                                    <th>Percentual</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaMedicamentosRelatorio"></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container footer-content">
            <span>
                ¬© <span id="year"></span> Secretaria de Efici√™ncia Governamental ‚Äî <strong>SEMEG</strong>
            </span>
            <span class="footer-divider">‚Ä¢</span>
            <span class="footer-sub">
                Sistema de Controle de Medicamentos | UBS Penta
            </span>
        </div>
    </footer>

    <!-- Toast de Notifica√ß√£o -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <script type="module" src="script.js"></script>


</body>

</html>